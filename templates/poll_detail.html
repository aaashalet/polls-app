{% extends "layout.html" %}

{% block content %}
  <h2>{{ poll.question }}</h2>

  {% if poll.image_filename %}
    <img src="{{ url_for('static', filename='uploads/' ~ poll.image_filename) }}" class="img-fluid" alt="Poll Image">
  {% endif %}

  <h4>Options</h4>
  <ul class="list-group">
    {% for option in poll.options %}
      <li class="list-group-item d-flex justify-content-between">
        {{ option.text }}
        <span class="badge bg-primary rounded-pill">
          {{ votes_count.get(option.id, 0) }} votes
        </span>
      </li>
    {% endfor %}
  </ul>

  {% if chart_filename %}
    <h5>Graph</h5>
    <img src="{{ url_for('static', filename='graphs/' ~ chart_filename) }}" alt="Poll Results Graph" class="img-fluid">
  {% endif %}
  
  <form method="POST">
    {% for option in poll.options %}
      <div class="form-check">
        <input class="form-check-input" type="radio" name="option" id="option{{ option.id }}" value="{{ option.id }}" required>
        <label class="form-check-label" for="option{{ option.id }}">
          {{ option.text }}
        </label>
      </div>
    {% endfor %}
    <button type="submit" class="btn btn-primary mt-3">Vote</button>
  </form>

  <a href="{{ url_for('index') }}" class="btn btn-secondary mt-3">Back to Polls</a>
{% endblock %}
